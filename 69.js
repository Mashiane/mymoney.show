(function(){var all=document.getElementsByTagName('*');for(var i=0;i<all.length;i++)if(typeof all[i].id!='undefined'&&typeof window[all[i].id]=='undefined')window[all[i].id]=all[i];})()
if((navigator.userAgent.indexOf('AppleWebKit')===-1)&&(navigator.userAgent.indexOf('Chrome')===-1)&&(navigator.userAgent.indexOf('MSIE 1')===-1)&&(navigator.userAgent.indexOf('BlackBerry')===-1)&&(navigator.userAgent.indexOf('RIM')===-1)&&(navigator.userAgent.indexOf('Tablet PC')===-1)){alert('Please use Google Chrome, Apple Safari or another supported browser. ('+navigator.userAgent+')');}
if(navigator.userAgent.indexOf('iPad')!==-1){var splashscreen=document.createElement('link');splashscreen.rel='apple-touch-startup-image';splashscreen.href='icon.png';document.getElementsByTagName('head')[0].appendChild(splashscreen);}
window.addEventListener('load',function(){WhatToDo.style.display='block';NSB.List_jqm_init('lstWhatToDo','My Categories,My Institutions,My Accounts,My Payments,My Reports,Read Me First',true,'100%',false);lstWhatToDo_ref=new iScroll('lstWhatToDo_scroller',{bounce:true,zoom:false});lstWhatToDo.refresh=function(){if(typeof lstWhatToDo_ref!='undefined')setTimeout(NSB.refresh,100,lstWhatToDo_ref)};NSB.addProperties(lstWhatToDo,lstWhatToDo_scroller);NSB.addProperties(hBar);NSB.addDisableProperty(hBar);if(typeof(hBar_left)!='undefined')hBar_left.onclick=function(){hBar.onclick(hBar_left.getAttribute('nsbvalue'))};if(typeof(hBar_right)!='undefined')hBar_right.onclick=function(){hBar.onclick(hBar_right.getAttribute('nsbvalue'))};WhatToDo.style.display='none';},false);WhatToDo.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(WhatToDo);lstWhatToDo.onclick=function(i){savethefunction_rvar="";if(TypeName(i)=="object"){return savethefunction_rvar;}
var strItem;strItem=lstWhatToDo.getItem(i);switch(True){case((strItem)=="My Categories"):ChangeForm(MyCategories);break;case((strItem)=="My Institutions"):ChangeForm(MyInstitutions);break;case((strItem)=="My Accounts"):ChangeForm(MyAccounts);break;case((strItem)=="My Payments"):ChangeForm(MyPayments);break;case((strItem)=="My Reports"):ChangeForm(MyReports);break;case((strItem)=="Read Me First"):}
return savethefunction_rvar;}
WhatToDo.onshow=function(){savethefunction_rvar="";lstWhatToDo.Top=hBar.Height;lstWhatToDo.Height=WhatToDo.Height-hBar.Height;return savethefunction_rvar;}
window.addEventListener('load',function(){MyCategories.style.display='block';NSB.List_jqm_init('mycategoriesList','Maintain Categories,Category Movements,Top 10 Categories,Category Report',false,'100%',false);mycategoriesList.refresh=function(){if(typeof mycategoriesList_ref!='undefined')setTimeout(NSB.refresh,100,mycategoriesList_ref)};NSB.addProperties(mycategoriesList);NSB.addProperties(mycatTitle);NSB.addDisableProperty(mycatTitle);if(typeof(mycatTitle_left)!='undefined')mycatTitle_left.onclick=function(){mycatTitle.onclick(mycatTitle_left.getAttribute('nsbvalue'))};if(typeof(mycatTitle_right)!='undefined')mycatTitle_right.onclick=function(){mycatTitle.onclick(mycatTitle_right.getAttribute('nsbvalue'))};MyCategories.style.display='none';},false);MyCategories.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(MyCategories);mycategoriesList.onclick=function(i){savethefunction_rvar="";if(TypeName(i)=="object"){return savethefunction_rvar;}
var strItem;strItem=mycategoriesList.getItem(i);switch(True){case((strItem)=="Maintain Categories"):ChangeForm(CategoriesList);break;case((strItem)=="Category Movements"):ChangeForm(CategoryMovements);break;case((strItem)=="Category Budgets"):catFrom="mycategories";ChangeForm(CategoryBudgets);break;case((strItem)=="Top 10 Categories"):ChangeForm(CategoryPerformance);break;case((strItem)=="Category Report"):ChangeForm(CategoryReport);}
return savethefunction_rvar;}
mycatTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Home"):ChangeForm(WhatToDo);}
return savethefunction_rvar;}
MyCategories.onshow=function(){savethefunction_rvar="";mycategoriesList.Top=mycatTitle.Height;mycategoriesList.Height=MyCategories.Height-mycatTitle.Height;return savethefunction_rvar;}
window.addEventListener('load',function(){MyAccounts.style.display='block';NSB.List_jqm_init('myaccountsList','Maintain Accounts,My Assets,My Liabilites,My Incomes,My Expenses,Account Movements,Top 10 Accounts,Account Report',true,'100%',false);myaccountsList_ref=new iScroll('myaccountsList_scroller',{bounce:true,zoom:false});myaccountsList.refresh=function(){if(typeof myaccountsList_ref!='undefined')setTimeout(NSB.refresh,100,myaccountsList_ref)};NSB.addProperties(myaccountsList,myaccountsList_scroller);NSB.addProperties(myaccountTitle);NSB.addDisableProperty(myaccountTitle);if(typeof(myaccountTitle_left)!='undefined')myaccountTitle_left.onclick=function(){myaccountTitle.onclick(myaccountTitle_left.getAttribute('nsbvalue'))};if(typeof(myaccountTitle_right)!='undefined')myaccountTitle_right.onclick=function(){myaccountTitle.onclick(myaccountTitle_right.getAttribute('nsbvalue'))};MyAccounts.style.display='none';},false);MyAccounts.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(MyAccounts);myaccountsList.onclick=function(i){savethefunction_rvar="";if(TypeName(i)=="object"){return savethefunction_rvar;}
var strItem;strItem=myaccountsList.getItem(i);switch(True){case((strItem)=="Maintain Accounts"):TypeOfList="all";ChangeForm(AccountsList);break;case((strItem)=="My Assets"):TypeOfList="assets";ChangeForm(AccountsList);break;case((strItem)=="My Liabilites"):TypeOfList="liabilities";ChangeForm(AccountsList);break;case((strItem)=="My Incomes"):TypeOfList="incomes";ChangeForm(AccountsList);break;case((strItem)=="My Expenses"):TypeOfList="expenses";ChangeForm(AccountsList);break;case((strItem)=="Account Movements"):catfrom="myaccounts";ChangeForm(AccountMovements);break;case((strItem)=="Top 10 Accounts"):ChangeForm(AccountPerformance);break;case((strItem)=="Account Report"):ChangeForm(AccountReport);}
return savethefunction_rvar;}
myaccountTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Home"):ChangeForm(WhatToDo);}
return savethefunction_rvar;}
MyAccounts.onshow=function(){savethefunction_rvar="";myaccountsList.Top=myaccountTitle.Height;myaccountsList.Height=MyAccounts.Height-myaccountTitle.Height;return savethefunction_rvar;}
window.addEventListener('load',function(){MyPayments.style.display='block';NSB.List_jqm_init('mypaymentsList','Make a Payment,Make Multiple Payments,Payments Report',false,'100%',false);mypaymentsList.refresh=function(){if(typeof mypaymentsList_ref!='undefined')setTimeout(NSB.refresh,100,mypaymentsList_ref)};NSB.addProperties(mypaymentsList);NSB.addProperties(mypaymentsTitle);NSB.addDisableProperty(mypaymentsTitle);if(typeof(mypaymentsTitle_left)!='undefined')mypaymentsTitle_left.onclick=function(){mypaymentsTitle.onclick(mypaymentsTitle_left.getAttribute('nsbvalue'))};if(typeof(mypaymentsTitle_right)!='undefined')mypaymentsTitle_right.onclick=function(){mypaymentsTitle.onclick(mypaymentsTitle_right.getAttribute('nsbvalue'))};MyPayments.style.display='none';},false);MyPayments.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(MyPayments);mypaymentsList.onclick=function(i){savethefunction_rvar="";if(TypeName(i)=="object"){return savethefunction_rvar;}
var strItem;strItem=mypaymentsList.getItem(i);switch(True){case((strItem)=="Make a Payment"):break;case((strItem)=="Make Multiple Payments"):break;case((strItem)=="Payments Report"):ChangeForm(PaymentsSelector);}
return savethefunction_rvar;}
mypaymentsTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Home"):ChangeForm(WhatToDo);}
return savethefunction_rvar;}
MyPayments.onshow=function(){savethefunction_rvar="";mypaymentsList.Top=mypaymentsTitle.Height;mypaymentsList.Height=MyPayments.Height-mypaymentsTitle.Height;return savethefunction_rvar;}
window.addEventListener('load',function(){MyReports.style.display='block';NSB.List_jqm_init('myreportsList','My Financial Position,Assets vs Liabilities,Incomes vs Expenses,My Financial Report',false,'100%',false);myreportsList.refresh=function(){if(typeof myreportsList_ref!='undefined')setTimeout(NSB.refresh,100,myreportsList_ref)};NSB.addProperties(myreportsList);NSB.addProperties(myreportTitle);NSB.addDisableProperty(myreportTitle);if(typeof(myreportTitle_left)!='undefined')myreportTitle_left.onclick=function(){myreportTitle.onclick(myreportTitle_left.getAttribute('nsbvalue'))};if(typeof(myreportTitle_right)!='undefined')myreportTitle_right.onclick=function(){myreportTitle.onclick(myreportTitle_right.getAttribute('nsbvalue'))};MyReports.style.display='none';},false);MyReports.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(MyReports);myreportTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Home"):ChangeForm(WhatToDo);}
return savethefunction_rvar;}
myreportsList.onclick=function(i){savethefunction_rvar="";if(TypeName(i)=="object"){return savethefunction_rvar;}
var strItem;strItem=myreportsList.getItem(i);switch(True){case((strItem)=="My Financial Position"):break;case((strItem)=="Assets vs Liabilities"):chartPer="AL";ChangeForm(Charts);break;case((strItem)=="Incomes vs Expenses"):chartPer="IE";ChangeForm(Charts);break;case((strItem)=="My Financial Report"):ChangeForm(FinancialReport);}
return savethefunction_rvar;}
MyReports.onshow=function(){savethefunction_rvar="";myreportsList.Top=myreportTitle.Height;myreportsList.Height=MyReports.Height-myreportTitle.Height;return savethefunction_rvar;}
window.addEventListener('load',function(){MyInstitutions.style.display='block';NSB.List_jqm_init('myinstitutionsList','',true,'100%',false);myinstitutionsList_ref=new iScroll('myinstitutionsList_scroller',{bounce:true,zoom:false});myinstitutionsList.refresh=function(){if(typeof myinstitutionsList_ref!='undefined')setTimeout(NSB.refresh,100,myinstitutionsList_ref)};NSB.addProperties(myinstitutionsList,myinstitutionsList_scroller);NSB.addProperties(myinstitutionsTitle);NSB.addDisableProperty(myinstitutionsTitle);if(typeof(myinstitutionsTitle_left)!='undefined')myinstitutionsTitle_left.onclick=function(){myinstitutionsTitle.onclick(myinstitutionsTitle_left.getAttribute('nsbvalue'))};if(typeof(myinstitutionsTitle_right)!='undefined')myinstitutionsTitle_right.onclick=function(){myinstitutionsTitle.onclick(myinstitutionsTitle_right.getAttribute('nsbvalue'))};MyInstitutions.style.display='none';},false);MyInstitutions.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(MyInstitutions);function LoadInstitutions(){savethefunction_rvar="";document.body.style.cursor='wait';NSB.ShowProgress("Loading institutions...");myinstitutionsList.Visible=False;myinstitutionsList.deleteItem("all");sqlList=[];sqlList[0]=["SELECT [Name] FROM Institutions ORDER BY [Name];",insHandler,insError];Sql(dbObj,sqlList);}
function insHandler(transaction,results){savethefunction_rvar="";for(i=0;i<=results.rows.length-1;i++){myinstitutionsList.addItem(results.rows.item(i)["Name"]);}
myinstitutionsList.Visible=True;myinstitutionsList.refresh();NSB.ShowProgress(False);document.body.style.cursor='default';return savethefunction_rvar;}
function insError(transaction,results){savethefunction_rvar="";NSB.ShowProgress(False);NSB.MsgBox("SQL Error");document.body.style.cursor='default';return savethefunction_rvar;}
myinstitutionsList.onclick=function(i){savethefunction_rvar="";if(TypeName(i)=="object"){return savethefunction_rvar;}
var strItem;strItem=myinstitutionsList.getItem(i);localStorage.institution=strItem;return savethefunction_rvar;}
myinstitutionsTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Home"):ChangeForm(WhatToDo);break;case((choice)=="Refresh"):LoadInstitutions();break;case((choice)=="Add"):InputInstitution();}
return savethefunction_rvar;}
MyInstitutions.onshow=function(){savethefunction_rvar="";myinstitutionsList.Top=myinstitutionsTitle.Height;myinstitutionsList.Height=MyInstitutions.Height-myinstitutionsTitle.Height;LoadInstitutions();return savethefunction_rvar;}
function InputInstitution(){savethefunction_rvar="";NSB.InputBox(InstitutionInputDone,"Please type the institution below.","Add Institution","");return savethefunction_rvar;}
function InstitutionInputDone(result,value){if(result==1&&Len(value)>0){var inst;inst=new Institution(-1,value);inst.nextid();inst.save();LoadInstitutions();}}
window.addEventListener('load',function(){MaintainCategories.style.display='block';maintainCategoriesMenu.refresh=function(){setTimeout(NSB.FooterBarRefresh,10,maintainCategoriesMenu)};NSB.FooterBar_jqm_init('maintainCategoriesMenu','Add,Save,Delete');NSB.addProperties(maintainCategoriesMenu);NSB.addProperties(maintainCategoriesTitle);NSB.addDisableProperty(maintainCategoriesTitle);if(typeof(maintainCategoriesTitle_left)!='undefined')maintainCategoriesTitle_left.onclick=function(){maintainCategoriesTitle.onclick(maintainCategoriesTitle_left.getAttribute('nsbvalue'))};if(typeof(maintainCategoriesTitle_right)!='undefined')maintainCategoriesTitle_right.onclick=function(){maintainCategoriesTitle.onclick(maintainCategoriesTitle_right.getAttribute('nsbvalue'))};NSB.addProperties(Label1);if(typeof txtAddCategoryName==='undefined')txtAddCategoryName=document.getElementById('txtAddCategoryName')
txtAddCategoryName.addEventListener('touchmove',function(e){e.stopPropagation();},false);NSB.addProperties(txtAddCategoryName,$('#txtAddCategoryName_wrapper > div')[0]);NSB.addDisableProperty(txtAddCategoryName)
MaintainCategories.style.display='none';},false);MaintainCategories.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(MaintainCategories);maintainCategoriesTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Back"):ChangeForm(CategoriesList);}
return savethefunction_rvar;}
maintainCategoriesMenu.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Add"):ClearCategory();break;case((choice)=="Save"):break;case((choice)=="Delete"):}
return savethefunction_rvar;}
MaintainCategories.onshow=function(){savethefunction_rvar="";maintainCategoriesMenu.Top=maintainCategoriesTitle.Height;return savethefunction_rvar;}
function ClearCategory(){txtAddCategoryName.text="";txtAddCategoryName.focus();}
window.addEventListener('load',function(){CategoriesList.style.display='block';NSB.List_jqm_init('categoriesListList','',true,'100%',false);categoriesListList_ref=new iScroll('categoriesListList_scroller',{bounce:true,zoom:false});categoriesListList.refresh=function(){if(typeof categoriesListList_ref!='undefined')setTimeout(NSB.refresh,100,categoriesListList_ref)};NSB.addProperties(categoriesListList,categoriesListList_scroller);NSB.addProperties(categorieslistTitle);NSB.addDisableProperty(categorieslistTitle);if(typeof(categorieslistTitle_left)!='undefined')categorieslistTitle_left.onclick=function(){categorieslistTitle.onclick(categorieslistTitle_left.getAttribute('nsbvalue'))};if(typeof(categorieslistTitle_right)!='undefined')categorieslistTitle_right.onclick=function(){categorieslistTitle.onclick(categorieslistTitle_right.getAttribute('nsbvalue'))};CategoriesList.style.display='none';},false);CategoriesList.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(CategoriesList);function LoadCategories(){document.body.style.cursor='wait';NSB.ShowProgress("Loading categories...");categoriesListList.Visible=False;categoriesListList.deleteItem("all");sqlList=[];sqlList[0]=["SELECT CategoryName FROM Categories ORDER BY CategoryName;",catHandler,catError];Sql(dbObj,sqlList);}
function catHandler(transaction,results){savethefunction_rvar="";for(i=0;i<=results.rows.length-1;i++){categoriesListList.addItem(results.rows.item(i)["CategoryName"]);}
NSB.ShowProgress(False);categoriesListList.Visible=True;categoriesListList.refresh();document.body.style.cursor='default';return savethefunction_rvar;}
function catError(transaction,results){savethefunction_rvar="";NSB.ShowProgress(False);NSB.MsgBox("SQL Error");document.body.style.cursor='default';return savethefunction_rvar;}
CategoriesList.onshow=function(){savethefunction_rvar="";categoriesListList.Top=categorieslistTitle.Height;categoriesListList.Height=CategoriesList.Height-categorieslistTitle.Height;LoadCategories();return savethefunction_rvar;}
categorieslistTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Back"):ChangeForm(MyCategories);break;case((choice)=="Add"):InputCategory();break;case((choice)=="Refresh"):LoadCategories();}
return savethefunction_rvar;}
categoriesListList.onclick=function(i){savethefunction_rvar="";if(TypeName(i)=="object"){return savethefunction_rvar;}
var strItem;strItem=categoriesListList.getItem(i);localStorage.category=strItem;return savethefunction_rvar;}
function InputCategory(){savethefunction_rvar="";NSB.InputBox(CategoryInputDone,"Please type the category below.","Add Category","");return savethefunction_rvar;}
function CategoryInputDone(result,value){if(result==1&&Len(value)>0){cat=new Category(-1,value,0);cat.save();LoadCategories();}}
var dbName,dbObj,cmData;var cmSource,cmDataAdapter,catKey;var catFrom,catYear,catName;var sqlList,rCnt,payYear,Query;var payMonth,payBy,VM,chartPer;var dailyPayments;function MapSum(mapobj,mapkey,mapitem){var xfound;xfound=False;var xsum;xsum=0;for(item in mapobj){NSB.Print((item+" "+mapkey+" "+mapobj[item]+" "+mapitem)+"<br>");if(item==mapkey){xfound=True;xsum=mapobj[item]+mapitem;mapobj.delete(item);mapobj[key]=xsum;}}
if(xfound==False){mapobj[mapkey]=mapitem;}}
function Main(){dbName="mymoneyshow.db";NSB.MsgBoxStyle="";dbObj=SqlOpenDatabase(dbName);if(dbObj==0){NSB.MsgBox("Error opening db");}
sqlList=[];VM=Chr(253);}
function SetHeaderTitle(hdObj,hdTitle){var shd;shd="#"+hdObj+" h1";$(shd).text(hdTitle);}
function GridCenterAlign(grdName,startCol,endCol){var grdRows;grdRows=grdName.getRowCount();for(i=1;i<=grdRows-1;i++){for(col=startCol;col<=endCol;col++){grdName.cell(i,col).style.textAlign="center";}}}
function GridRightAlign(grdName,startCol,endCol){var grdRows;grdRows=grdName.getRowCount();for(i=1;i<=grdRows-1;i++){for(col=startCol;col<=endCol;col++){grdName.cell(i,col).style.textAlign="right";}}}
function SetGridHeight(grdName,grdRowHeight){var grdRows;grdRows=grdName.getRowCount();for(i=1;i<=grdRows-1;i++){grdName.setRowHeight(i,grdRowHeight);}}
function AlternateGridColor(grdName){var grdRows,grdCols;grdRows=grdName.getRowCount();grdCols=grdName.getColCount();for(i=1;i<=grdRows-1;i++){for(col=0;col<=grdCols-1;col++){if((Math.abs(i)%2)==1){grdName.cell(i,col).style.backgroundColor=RGB(255,255,240);}else{grdName.cell(i,col).style.backgroundColor=RGB(240,248,255);}}}}
function Institution(id,name){savethefunction_rvar="";this.id=id;this.name=name;return savethefunction_rvar;}
function saveInstitution(){savethefunction_rvar="";var s;sqlList=[];s=Join([this.id,"'"+this.name+"'"],",");sqlList[0]=["INSERT INTO Institutions (Id, Name) VALUES ( "+s+");",saveInstOk,saveInstError];Sql(dbObj,sqlList);return savethefunction_rvar;}
function saveInstOk(transaction,results){savethefunction_rvar="";NSB.MsgBox("Institution successfully saved.");return savethefunction_rvar;}
function saveInstError(transaction,results){savethefunction_rvar="";NSB.MsgBox("Institution could not be saved.");return savethefunction_rvar;}
function nextInstId(){savethefunction_rvar="";sqlList=[];sqlList[0]=["SELECT MAX(Id) as MaxValue FROM Institutions;",maxOk,maxError];Sql(dbObj,sqlList);return savethefunction_rvar;}
function maxOk(transaction,results){savethefunction_rvar="";this.id=results.rows.item(0)["MaxValue"];this.id=this.id+1;return savethefunction_rvar;}
function maxError(transaction,results){savethefunction_rvar="";this.id=-1;return savethefunction_rvar;}
Institution.prototype.nextid=nextInstId;Institution.prototype.save=saveInstitution;function Category(id,categoryname,transactions){savethefunction_rvar="";this.id=id;this.categoryname=categoryname;this.transactions=transactions;return savethefunction_rvar;}
function saveCategory(){savethefunction_rvar="";var s;sqlList=[];s=Join([this.id,"'"+this.categoryname+"'",this.transactions],",");sqlList[0]=["INSERT INTO Categories (CategoryId, CategoryName, Transactions) VALUES ( "+s+");",saveCatOk,saveCatError];Sql(dbObj,sqlList);return savethefunction_rvar;}
function saveCatOk(transaction,result){savethefunction_rvar="";NSB.MsgBox("Category successfully saved.");return savethefunction_rvar;}
function saveCatError(transaction,result){savethefunction_rvar="";NSB.MsgBox("Category could not be saved.");return savethefunction_rvar;}
Category.prototype.save=saveCategory;window.addEventListener('load',function(){CategoryMovements.style.display='block';NSB.addProperties(categoryMovementTitle);NSB.addDisableProperty(categoryMovementTitle);if(typeof(categoryMovementTitle_left)!='undefined')categoryMovementTitle_left.onclick=function(){categoryMovementTitle.onclick(categoryMovementTitle_left.getAttribute('nsbvalue'))};if(typeof(categoryMovementTitle_right)!='undefined')categoryMovementTitle_right.onclick=function(){categoryMovementTitle.onclick(categoryMovementTitle_right.getAttribute('nsbvalue'))};grdCategoryMovements_ref=new iScroll('grdCategoryMovements_scroller',{bounce:true,zoom:false});grdCategoryMovements.refresh=function(){setTimeout(NSB.refresh,100,grdCategoryMovements_ref)};grdCategoryMovements.GridRefreshWidth=function(){setTimeout(NSB.GridRefreshWidth,10,grdCategoryMovements)};NSB.Grid_init('grdCategoryMovements');NSB.addProperties(grdCategoryMovements,grdCategoryMovements_scroller)
CategoryMovements.style.display='none';},false);CategoryMovements.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(CategoryMovements);function LoadCategoryMovements(){savethefunction_rvar="";document.body.style.cursor='wait';NSB.ShowProgress("Loading category movements...");rCnt=grdCategoryMovements.getRowCount();grdCategoryMovements.deleteRows(rCnt);grdCategoryMovements.refresh();$("#grdCategoryMovements td").css("font-family","helvetica");sqlList=[];sqlList[0]=["SELECT * FROM [Category_Movement] ORDER BY [YearOn] DESC,AccountName;",cmHandler,cmError];Sql(dbObj,sqlList);}
function cmHandler(transaction,results){savethefunction_rvar="";rCnt=1;var rec,imgID;for(i=0;i<=(results.rows.length-1);i++){rec=results.rows.item(i);grdCategoryMovements.addRows(1);grdCategoryMovements.setValue(rCnt,0,rec["YearOn"]);grdCategoryMovements.setValue(rCnt,1,rec["AccountName"]);imgID="grdCategoryMovements_"+rCnt+"_2";grdCategoryMovements.setValue(rCnt,2,"<img src='view.png' id='"+imgID+"'>");imgID="grdCategoryMovements_"+rCnt+"_3";grdCategoryMovements.setValue(rCnt,3,"<img src='chart.png' id='"+imgID+"'>");grdCategoryMovements.setValue(rCnt,4,FormatNumber(rec["ActualJan"],2));grdCategoryMovements.setValue(rCnt,5,FormatNumber(rec["ActualFeb"],2));grdCategoryMovements.setValue(rCnt,6,FormatNumber(rec["ActualMar"],2));grdCategoryMovements.setValue(rCnt,7,FormatNumber(rec["ActualApr"],2));grdCategoryMovements.setValue(rCnt,8,FormatNumber(rec["ActualMay"],2));grdCategoryMovements.setValue(rCnt,9,FormatNumber(rec["ActualJun"],2));grdCategoryMovements.setValue(rCnt,10,FormatNumber(rec["ActualJul"],2));grdCategoryMovements.setValue(rCnt,11,FormatNumber(rec["ActualAug"],2));grdCategoryMovements.setValue(rCnt,12,FormatNumber(rec["ActualSep"],2));grdCategoryMovements.setValue(rCnt,13,FormatNumber(rec["ActualOct"],2));grdCategoryMovements.setValue(rCnt,14,FormatNumber(rec["ActualNov"],2));grdCategoryMovements.setValue(rCnt,15,FormatNumber(rec["ActualDec"],2));grdCategoryMovements.setValue(rCnt,16,FormatNumber(rec["Actual"],2));rCnt=rCnt+1;}
SetGridHeight(grdCategoryMovements,"32px");GridCenterAlign(grdCategoryMovements,2,3);GridRightAlign(grdCategoryMovements,4,16);AlternateGridColor(grdCategoryMovements);grdCategoryMovements.Left=0;grdCategoryMovements.Top=categoryMovementTitle.Height;grdCategoryMovements.Height=CategoryMovements.Height-categoryMovementTitle.Height;grdCategoryMovements.Width=CategoryMovements.Width;grdCategoryMovements.refresh();NSB.ShowProgress(False);document.body.style.cursor='default';return savethefunction_rvar;}
function cmError(transaction,results){savethefunction_rvar="";NSB.ShowProgress(False);NSB.MsgBox("SQL Error");document.body.style.cursor='default';return savethefunction_rvar;}
categoryMovementTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Back"):ChangeForm(MyCategories);break;case((choice)=="Refresh"):LoadCategoryMovements();}
return savethefunction_rvar;}
CategoryMovements.onshow=function(){savethefunction_rvar="";LoadCategoryMovements();return savethefunction_rvar;}
grdCategoryMovements.onclick=function(){savethefunction_rvar="";var gRowCol,gCol,gRow;gRowCol=Split(event.target.id,"_");gRow=gRowCol[1];gCol=gRowCol[2];catYear=grdCategoryMovements.getValue(gRow,0);catName=grdCategoryMovements.getValue(gRow,1);catKey=escape(catYear+"-"+catName);lblCatName.textContent=Replace(unescape(catKey),"-"," : ");switch(True){case((gCol)==3):catFrom="catChart";ChangeForm(CategoryBudgets);break;case((gCol)==2):catFrom="catMove";ChangeForm(CategoryBudgets);}
return savethefunction_rvar;}
window.addEventListener('load',function(){CategoryBudgets.style.display='block';NSB.addProperties(categoryBudgetsTitle);NSB.addDisableProperty(categoryBudgetsTitle);if(typeof(categoryBudgetsTitle_left)!='undefined')categoryBudgetsTitle_left.onclick=function(){categoryBudgetsTitle.onclick(categoryBudgetsTitle_left.getAttribute('nsbvalue'))};if(typeof(categoryBudgetsTitle_right)!='undefined')categoryBudgetsTitle_right.onclick=function(){categoryBudgetsTitle.onclick(categoryBudgetsTitle_right.getAttribute('nsbvalue'))};NSB.addProperties(lblCatName);categoryYearlyChart_settings={'title':'','background':'white','description':'','padding':{left:10,top:10,right:10,bottom:10},'titlePadding':{left:2,top:2,right:2,bottom:2},'colorScheme':'scheme01','showLegend':'true','enabled':'true','showToolTips':'true','toolTipDelay':'500'}
categoryYearlyChart.style.position='relative';NSB.addProperties(categoryYearlyChart,categoryYearlyChart_wrapper);grdCategoryBudgets_ref=new iScroll('grdCategoryBudgets_scroller',{bounce:true,zoom:false});grdCategoryBudgets.refresh=function(){setTimeout(NSB.refresh,100,grdCategoryBudgets_ref)};grdCategoryBudgets.GridRefreshWidth=function(){setTimeout(NSB.GridRefreshWidth,10,grdCategoryBudgets)};NSB.Grid_init('grdCategoryBudgets');NSB.addProperties(grdCategoryBudgets,grdCategoryBudgets_scroller)
CategoryBudgets.style.display='none';},false);CategoryBudgets.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(CategoryBudgets);function LoadCategoryBudgets(){savethefunction_rvar="";document.body.style.cursor='wait';NSB.ShowProgress("Loading category budgets...");switch(True){case((catFrom)=="catMove"):$("#categoryBudgetsTitle h1").text("Category Budgets");rCnt=grdCategoryBudgets.getRowCount();grdCategoryBudgets.deleteRows(rCnt);grdCategoryBudgets.refresh();$("#grdCategoryBudgets td").css("font-family","helvetica");break;case((catFrom)=="catChart"):$("#categoryBudgetsTitle h1").text("Category Chart");}
sqlList=[];sqlList[0]=["SELECT * FROM [Category_Movement] WHERE Id = '"+unescape(catKey)+"';",cbHandler,cbError];Sql(dbObj,sqlList);}
function cbHandler(transaction,results){savethefunction_rvar="";catBudgetChart=[];var sAmt1,sAmt2;for(i=0;i<=results.rows.length-1;i++){rCnt=1;for(y=0;y<=11;y++){var mName;var ddmmyyyy;ddmmyyyy=CStr(Year(dateadd("s",0,new Date())))+"-"+CStr(y+1)+"-01";mName=Left(CStr(MonthName(CDate(ddmmyyyy))),3);switch(True){case((catFrom)=="catChart"):var row;row={}
row["period"]=mName;row["budget"]=results.rows.item(i)["Budget"+mName];row["actual"]=results.rows.item(i)["Actual"+mName];catBudgetChart[y]=row;break;case((catFrom)=="catMove"):sAmt1=results.rows.item(i)["Budget"+mName];sAmt2=results.rows.item(i)["Actual"+mName];sAmt1=FormatNumber(sAmt1,2);sAmt2=FormatNumber(sAmt2,2);grdCategoryBudgets.addRows(1);grdCategoryBudgets.setValue(rCnt,0,mName);grdCategoryBudgets.setValue(rCnt,1,sAmt1);grdCategoryBudgets.setValue(rCnt,2,sAmt2);}
rCnt=rCnt+1;}
switch(True){case((catFrom)=="catMove"):sAmt1=results.rows.item(i)["Budget"];sAmt2=results.rows.item(i)["Actual"];sAmt1=FormatNumber(sAmt1,2);sAmt2=FormatNumber(sAmt2,2);grdCategoryBudgets.addRows(1);grdCategoryBudgets.setValue(rCnt,0,"Total");grdCategoryBudgets.setValue(rCnt,1,sAmt1);grdCategoryBudgets.setValue(rCnt,2,sAmt2);}}
switch(True){case((catFrom)=="catMove"):SetGridHeight(grdCategoryBudgets,"32px");GridRightAlign(grdCategoryBudgets,1,2);AlternateGridColor(grdCategoryBudgets);grdCategoryBudgets.Left=0;grdCategoryBudgets.Top=75;grdCategoryBudgets.Height=CategoryBudgets.Height-75;grdCategoryBudgets.Width=CategoryBudgets.Width;grdCategoryBudgets.Visible=True;categoryYearlyChart.Visible=False;grdCategoryBudgets.refresh();break;case((catFrom)=="catChart"):categoryYearlyChart.Left=0;categoryYearlyChart.Top=75;categoryYearlyChart.Height=CategoryBudgets.Height-75;categoryYearlyChart.Width=CategoryBudgets.Width;grdCategoryBudgets.Visible=False;categoryYearlyChart.Visible=True;categoryYearlyChart_settings.showBorderLine=False;categoryYearlyChart_settings.source=catBudgetChart;categoryYearlyChart_settings.categoryAxis={dataField:"period",showGridLines:True,textRotationAngle:-90}
categoryYearlyChart_settings.seriesGroups=[{type:"column",valueAxis:{description:"Amounts",formatSettings:{prefix:"",thousandsSeparator:","}},series:[{dataField:"budget",displayText:"Budget"},{dataField:"actual",displayText:"Actual"},]}];$("#categoryYearlyChart").jqxChart(categoryYearlyChart_settings);}
NSB.ShowProgress(False);document.body.style.cursor='default';return savethefunction_rvar;}
function cbError(transaction,results){savethefunction_rvar="";NSB.ShowProgress(False);NSB.MsgBox("SQL Error");document.body.style.cursor='default';return savethefunction_rvar;}
categoryBudgetsTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Chart"):catFrom="catChart";LoadCategoryBudgets();break;case((choice)=="Back"):switch(True){case((catFrom)=="catChart"):grdCategoryBudgets.Visible=True;categoryYearlyChart.Visible=False;grdCategoryBudgets.refresh();catFrom="catMove";break;case((catFrom)=="catMove"):ChangeForm(CategoryMovements);break;}}
return savethefunction_rvar;}
CategoryBudgets.onshow=function(){savethefunction_rvar="";lblCatName.Width=CategoryBudgets.Width;LoadCategoryBudgets();return savethefunction_rvar;}
window.addEventListener('load',function(){CategoryPerformance.style.display='block';NSB.addProperties(catPerformanceTitle);NSB.addDisableProperty(catPerformanceTitle);if(typeof(catPerformanceTitle_left)!='undefined')catPerformanceTitle_left.onclick=function(){catPerformanceTitle.onclick(catPerformanceTitle_left.getAttribute('nsbvalue'))};if(typeof(catPerformanceTitle_right)!='undefined')catPerformanceTitle_right.onclick=function(){catPerformanceTitle.onclick(catPerformanceTitle_right.getAttribute('nsbvalue'))};catPerformanceChart_settings={'title':'','background':'white','description':'','padding':{left:10,top:10,right:10,bottom:10},'titlePadding':{left:2,top:2,right:2,bottom:2},'colorScheme':'scheme01','showLegend':'true','enabled':'true','showToolTips':'true','toolTipDelay':'500'}
catPerformanceChart.style.position='relative';NSB.addProperties(catPerformanceChart,catPerformanceChart_wrapper);CategoryPerformance.style.display='none';},false);CategoryPerformance.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(CategoryPerformance);function LoadCategoryPerformance(){savethefunction_rvar="";document.body.style.cursor='wait';NSB.ShowProgress("Loading category performance...");var sQRY;sqlList=[];sQRY="SELECT AccountName, SUM(Actual) AS Actual FROM Category_Movement WHERE Actual > 0";sQRY=sQRY+" GROUP BY AccountName ORDER BY Actual DESC;";sqlList[0]=[sQRY,cpHandler,cpError];Sql(dbObj,sqlList);}
function cpHandler(transaction,results){savethefunction_rvar="";cmData=[];for(i=0;i<=results.rows.length-1;i++){if(i<=9){var row;row={}
row["account"]=results.rows.item(i)["AccountName"];row["actual"]=results.rows.item(i)["Actual"];cmData[i]=row;}else{break;}}
catPerformanceChart.Left=0;catPerformanceChart.Top=catPerformanceTitle.Height;catPerformanceChart.Height=CategoryPerformance.Height-catPerformanceTitle.Height;catPerformanceChart.Width=CategoryPerformance.Width;catPerformanceChart_settings.showBorderLine=False;catPerformanceChart_settings.source=cmData;catPerformanceChart_settings.showLegend=False;catPerformanceChart_settings.categoryAxis={dataField:"account",showGridLines:True,textRotationAngle:-90}
catPerformanceChart_settings.seriesGroups=[{type:"column",valueAxis:{description:"Actual",formatSettings:{prefix:"",thousandsSeparator:","}},series:[{dataField:"actual",displayText:"Actual"},]}];$("#catPerformanceChart").jqxChart(catPerformanceChart_settings);NSB.ShowProgress(False);document.body.style.cursor='default';return savethefunction_rvar;}
function cpError(transaction,results){savethefunction_rvar="";NSB.ShowProgress(False);NSB.MsgBox("SQL Error");document.body.style.cursor='default';return savethefunction_rvar;}
catPerformanceTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Back"):ChangeForm(MyCategories);break;case((choice)=="Refresh"):LoadCategoryPerformance();break;case((choice)=="Save"):$("#catPerformanceChart").jqxChart("saveAsPNG","mms_categoryperformance.png");}
return savethefunction_rvar;}
CategoryPerformance.onshow=function(){savethefunction_rvar="";LoadCategoryPerformance();return savethefunction_rvar;}
window.addEventListener('load',function(){CategoryReport.style.display='block';NSB.addProperties(catReportTitle);NSB.addDisableProperty(catReportTitle);if(typeof(catReportTitle_left)!='undefined')catReportTitle_left.onclick=function(){catReportTitle.onclick(catReportTitle_left.getAttribute('nsbvalue'))};if(typeof(catReportTitle_right)!='undefined')catReportTitle_right.onclick=function(){catReportTitle.onclick(catReportTitle_right.getAttribute('nsbvalue'))};grdCatReport_ref=new iScroll('grdCatReport_scroller',{bounce:true,zoom:false});grdCatReport.refresh=function(){setTimeout(NSB.refresh,100,grdCatReport_ref)};grdCatReport.GridRefreshWidth=function(){setTimeout(NSB.GridRefreshWidth,10,grdCatReport)};NSB.Grid_init('grdCatReport');NSB.addProperties(grdCatReport,grdCatReport_scroller)
CategoryReport.style.display='none';},false);CategoryReport.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(CategoryReport);function LoadCategoryReport(){savethefunction_rvar="";document.body.style.cursor='wait';NSB.ShowProgress("Loading category report...");rCnt=grdCatReport.getRowCount();grdCatReport.deleteRows(rCnt);grdCatReport.refresh();$("#grdCatReport td").css("font-family","helvetica");var sQRY;sqlList=[];sQRY="SELECT AccountName, SUM(Actual) AS Actual FROM Category_Movement WHERE Actual > 0";sQRY=sQRY+" GROUP BY AccountName ORDER BY Actual DESC;";sqlList[0]=[sQRY,crepHandler,crepError];Sql(dbObj,sqlList);}
function crepHandler(transaction,results){savethefunction_rvar="";rCnt=1;var sAmt;var row;var sPerc;var cTotal;cTotal=0;sPerc=0;for(i=0;i<=results.rows.length-1;i++){row=results.rows.item(i);cTotal=cTotal+row["Actual"];}
for(i=0;i<=results.rows.length-1;i++){row=results.rows.item(i);sAmt=row["Actual"];sPerc=sAmt/cTotal;sPerc=sPerc*100;sAmt=FormatNumber(sAmt,2);sPerc=FormatNumber(sPerc,2);grdCatReport.addRows(1);grdCatReport.setValue(rCnt,0,row["AccountName"]);grdCatReport.setValue(rCnt,1,sAmt);grdCatReport.setValue(rCnt,2,sPerc);rCnt=rCnt+1;}
SetGridHeight(grdCatReport,"32px");GridRightAlign(grdCatReport,1,2);AlternateGridColor(grdCatReport);grdCatReport.Left=0;grdCatReport.Top=catReportTitle.Height;grdCatReport.Height=CategoryReport.Height-catReportTitle.Height;grdCatReport.Width=CategoryReport.Width;grdCatReport.refresh();NSB.ShowProgress(False);document.body.style.cursor='default';return savethefunction_rvar;}
function crepError(transaction,results){savethefunction_rvar="";NSB.ShowProgress(False);NSB.MsgBox("SQL Error");document.body.style.cursor='default';return savethefunction_rvar;}
catReportTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Back"):ChangeForm(MyCategories);break;case((choice)=="Refresh"):LoadCategoryReport();}
return savethefunction_rvar;}
CategoryReport.onshow=function(){savethefunction_rvar="";LoadCategoryReport();return savethefunction_rvar;}
window.addEventListener('load',function(){AccountsList.style.display='block';NSB.addProperties(accListTitle);NSB.addDisableProperty(accListTitle);if(typeof(accListTitle_left)!='undefined')accListTitle_left.onclick=function(){accListTitle.onclick(accListTitle_left.getAttribute('nsbvalue'))};if(typeof(accListTitle_right)!='undefined')accListTitle_right.onclick=function(){accListTitle.onclick(accListTitle_right.getAttribute('nsbvalue'))};NSB.List_jqm_init('lstAccounts','',true,'100%',false);lstAccounts_ref=new iScroll('lstAccounts_scroller',{bounce:true,zoom:false});lstAccounts.refresh=function(){if(typeof lstAccounts_ref!='undefined')setTimeout(NSB.refresh,100,lstAccounts_ref)};NSB.addProperties(lstAccounts,lstAccounts_scroller);AccountsList.style.display='none';},false);AccountsList.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(AccountsList);var TypeOfList;function LoadAccounts(){savethefunction_rvar="";document.body.style.cursor='wait';NSB.ShowProgress("Loading accounts...");lstAccounts.Visible=False;lstAccounts.deleteItem("all");sqlList=[];switch(True){case((TypeOfList)=="all"):$("#accListTitle h1").text("Maintain Accounts");sqlList[0]=["SELECT [Name] FROM Accounts ORDER BY [Name];",accountsOk,accountsError];break;case((TypeOfList)=="assets"):$("#accListTitle h1").text("My Assets");sqlList[0]=["SELECT [Name] FROM Accounts where TypeOf = 'Assets' ORDER BY [Name];",accountsOk,accountsError];break;case((TypeOfList)=="liabilities"):$("#accListTitle h1").text("My Liabilities");sqlList[0]=["SELECT [Name] FROM Accounts where TypeOf = 'Liabilities' ORDER BY [Name];",accountsOk,accountsError];break;case((TypeOfList)=="incomes"):$("#accListTitle h1").text("My Incomes");sqlList[0]=["SELECT [Name] FROM Accounts where TypeOf = 'Incomes' ORDER BY [Name];",accountsOk,accountsError];break;case((TypeOfList)=="expenses"):$("#accListTitle h1").text("My Expenses");sqlList[0]=["SELECT [Name] FROM Accounts where TypeOf = 'Expenses' ORDER BY [Name];",accountsOk,accountsError];}
Sql(dbObj,sqlList);}
function accountsOk(transaction,results){savethefunction_rvar="";for(i=0;i<=results.rows.length-1;i++){lstAccounts.addItem(results.rows.item(i)["Name"]);}
lstAccounts.Top=accListTitle.Height;lstAccounts.Height=AccountsList.Height-accListTitle.Height;lstAccounts.Visible=True;lstAccounts.refresh();NSB.ShowProgress(False);document.body.style.cursor='default';return savethefunction_rvar;}
function accountsError(transaction,results){savethefunction_rvar="";NSB.ShowProgress(False);NSB.MsgBox("SQL Error");document.body.style.cursor='default';return savethefunction_rvar;}
accListTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Back"):ChangeForm(MyAccounts);break;case((choice)=="Add"):ChangeForm(Account);}
return savethefunction_rvar;}
AccountsList.onshow=function(){savethefunction_rvar="";LoadAccounts();return savethefunction_rvar;}
window.addEventListener('load',function(){AccountMovements.style.display='block';NSB.addProperties(accMovementTitle);NSB.addDisableProperty(accMovementTitle);if(typeof(accMovementTitle_left)!='undefined')accMovementTitle_left.onclick=function(){accMovementTitle.onclick(accMovementTitle_left.getAttribute('nsbvalue'))};if(typeof(accMovementTitle_right)!='undefined')accMovementTitle_right.onclick=function(){accMovementTitle.onclick(accMovementTitle_right.getAttribute('nsbvalue'))};grdAccountMovements_ref=new iScroll('grdAccountMovements_scroller',{bounce:true,zoom:false});grdAccountMovements.refresh=function(){setTimeout(NSB.refresh,100,grdAccountMovements_ref)};grdAccountMovements.GridRefreshWidth=function(){setTimeout(NSB.GridRefreshWidth,10,grdAccountMovements)};NSB.Grid_init('grdAccountMovements');NSB.addProperties(grdAccountMovements,grdAccountMovements_scroller)
AccountMovements.style.display='none';},false);AccountMovements.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(AccountMovements);function LoadAccountMovements(){savethefunction_rvar="";document.body.style.cursor='wait';NSB.ShowProgress("Loading account movements...");rCnt=grdAccountMovements.getRowCount();grdAccountMovements.deleteRows(rCnt);grdAccountMovements.refresh();$("#grdAccountMovements td").css("font-family","helvetica");sqlList=[];sqlList[0]=["SELECT * FROM [Accounts_Movement] ORDER BY [YearOn] DESC,AccountName;",amHandler,amError];Sql(dbObj,sqlList);}
function amHandler(transaction,results){savethefunction_rvar="";rCnt=1;var rec,imgID;for(i=0;i<=results.rows.length-1;i++){rec=results.rows.item(i);grdAccountMovements.addRows(1);grdAccountMovements.setValue(rCnt,0,rec["YearOn"]);grdAccountMovements.setValue(rCnt,1,rec["AccountName"]);imgID="grdAccountMovements_"+rCnt+"_2";grdAccountMovements.setValue(rCnt,2,"<img src='view.png' id='"+imgID+"'>");imgID="grdAccountMovements_"+rCnt+"_3";grdAccountMovements.setValue(rCnt,3,"<img src='chart.png' id='"+imgID+"'>");grdAccountMovements.setValue(rCnt,4,FormatNumber(rec["ActualJan"],2));grdAccountMovements.setValue(rCnt,5,FormatNumber(rec["ActualFeb"],2));grdAccountMovements.setValue(rCnt,6,FormatNumber(rec["ActualMar"],2));grdAccountMovements.setValue(rCnt,7,FormatNumber(rec["ActualApr"],2));grdAccountMovements.setValue(rCnt,8,FormatNumber(rec["ActualMay"],2));grdAccountMovements.setValue(rCnt,9,FormatNumber(rec["ActualJun"],2));grdAccountMovements.setValue(rCnt,10,FormatNumber(rec["ActualJul"],2));grdAccountMovements.setValue(rCnt,11,FormatNumber(rec["ActualAug"],2));grdAccountMovements.setValue(rCnt,12,FormatNumber(rec["ActualSep"],2));grdAccountMovements.setValue(rCnt,13,FormatNumber(rec["ActualOct"],2));grdAccountMovements.setValue(rCnt,14,FormatNumber(rec["ActualNov"],2));grdAccountMovements.setValue(rCnt,15,FormatNumber(rec["ActualDec"],2));grdAccountMovements.setValue(rCnt,16,FormatNumber(rec["Actual"],2));rCnt=rCnt+1;}
SetGridHeight(grdAccountMovements,"32px");GridCenterAlign(grdAccountMovements,2,3);GridRightAlign(grdAccountMovements,4,16);AlternateGridColor(grdAccountMovements);grdAccountMovements.Left=0;grdAccountMovements.Top=accMovementTitle.Height;grdAccountMovements.Height=AccountMovements.Height-accMovementTitle.Height;grdAccountMovements.Width=AccountMovements.Width;grdAccountMovements.refresh();NSB.ShowProgress(False);document.body.style.cursor='default';return savethefunction_rvar;}
function amError(transaction,results){savethefunction_rvar="";NSB.ShowProgress(False);NSB.MsgBox("SQL Error");document.body.style.cursor='default';return savethefunction_rvar;}
accMovementTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Back"):ChangeForm(MyAccounts);break;case((choice)=="Refresh"):LoadAccountMovements();}
return savethefunction_rvar;}
AccountMovements.onshow=function(){savethefunction_rvar="";LoadAccountMovements();return savethefunction_rvar;}
function grdAccountMovementsReady(){savethefunction_rvar="";console.log("Grid load complete");return savethefunction_rvar;}
grdAccountMovements.onclick=function(){savethefunction_rvar="";var gRowCol,gCol,gRow;gRowCol=Split(event.target.id,"_");gRow=gRowCol[1];gCol=gRowCol[2];catYear=grdAccountMovements.getValue(gRow,0);catName=grdAccountMovements.getValue(gRow,1);catKey=escape(catYear+"-"+catName);lblAccName.textContent=Replace(unescape(catKey),"-"," : ");switch(True){case((gCol)==3):catFrom="accChart";ChangeForm(AccountBudgets);break;case((gCol)==2):catFrom="accMove";ChangeForm(AccountBudgets);}
return savethefunction_rvar;}
window.addEventListener('load',function(){AccountBudgets.style.display='block';NSB.addProperties(accountBudgetsTitle);NSB.addDisableProperty(accountBudgetsTitle);if(typeof(accountBudgetsTitle_left)!='undefined')accountBudgetsTitle_left.onclick=function(){accountBudgetsTitle.onclick(accountBudgetsTitle_left.getAttribute('nsbvalue'))};if(typeof(accountBudgetsTitle_right)!='undefined')accountBudgetsTitle_right.onclick=function(){accountBudgetsTitle.onclick(accountBudgetsTitle_right.getAttribute('nsbvalue'))};NSB.addProperties(lblAccName);accountYearlyChart_settings={'title':'','background':'white','description':'','padding':{left:10,top:10,right:10,bottom:10},'titlePadding':{left:2,top:2,right:2,bottom:2},'colorScheme':'scheme01','showLegend':'true','enabled':'true','showToolTips':'true','toolTipDelay':'500'}
accountYearlyChart.style.position='relative';NSB.addProperties(accountYearlyChart,accountYearlyChart_wrapper);grdAccountBudgets_ref=new iScroll('grdAccountBudgets_scroller',{bounce:true,zoom:false});grdAccountBudgets.refresh=function(){setTimeout(NSB.refresh,100,grdAccountBudgets_ref)};grdAccountBudgets.GridRefreshWidth=function(){setTimeout(NSB.GridRefreshWidth,10,grdAccountBudgets)};NSB.Grid_init('grdAccountBudgets');NSB.addProperties(grdAccountBudgets,grdAccountBudgets_scroller)
AccountBudgets.style.display='none';},false);AccountBudgets.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(AccountBudgets);var accBudgetChart;function LoadAccountBudgets(){savethefunction_rvar="";document.body.style.cursor='wait';NSB.ShowProgress("Loading account budgets...");switch(True){case((catFrom)=="accChart"):$("#accountBudgetsTitle h1").text("Account Chart");grdAccountBudgets.Visible=False;accountYearlyChart.Visible=True;break;case((catFrom)=="accMove"):$("#accountBudgetsTitle h1").text("Account Budgets");grdAccountBudgets.Visible=True;accountYearlyChart.Visible=False;rCnt=grdAccountBudgets.getRowCount();grdAccountBudgets.deleteRows(rCnt);grdAccountBudgets.refresh();$("#grdAccountBudgets td").css("font-family","helvetica");}
sqlList=[];sqlList[0]=["SELECT * FROM [Accounts_Movement] WHERE Id = '"+unescape(catKey)+"';",abHandler,abError];Sql(dbObj,sqlList);}
function abHandler(transaction,results){savethefunction_rvar="";accBudgetChart=[];var sAmt1,sAmt2,imgID;for(i=0;i<=results.rows.length-1;i++){rCnt=1;for(y=0;y<=11;y++){var mName;var ddmmyyyy;ddmmyyyy=CStr(Year(dateadd("s",0,new Date())))+"-"+CStr(y+1)+"-01";mName=Left(CStr(MonthName(CDate(ddmmyyyy))),3);switch(True){case((catFrom)=="accChart"):var row;row={}
row["period"]=mName;row["budget"]=results.rows.item(i)["Budget"+mName];row["actual"]=results.rows.item(i)["Actual"+mName];accBudgetChart[y]=row;break;case((catFrom)=="accMove"):sAmt1=results.rows.item(i)["Budget"+mName];sAmt2=results.rows.item(i)["Actual"+mName];sAmt2=FormatNumber(sAmt2,2);sAmt1=FormatNumber(sAmt1,2);grdAccountBudgets.addRows(1);grdAccountBudgets.setValue(rCnt,0,mName);grdAccountBudgets.setValue(rCnt,1,sAmt1);grdAccountBudgets.setValue(rCnt,2,sAmt2);imgID="grdAccountBudgets_"+rCnt+"_3";grdAccountBudgets.setValue(rCnt,3,"<img src='chart.png' id='"+imgID+"'>");}
rCnt=rCnt+1;}
switch(True){case((catFrom)=="accMove"):sAmt1=results.rows.item(i)["Budget"];sAmt2=results.rows.item(i)["Actual"];sAmt2=FormatNumber(sAmt2,2);sAmt1=FormatNumber(sAmt1,2);grdAccountBudgets.addRows(1);grdAccountBudgets.setValue(rCnt,0,"Total");grdAccountBudgets.setValue(rCnt,1,sAmt1);grdAccountBudgets.setValue(rCnt,2,sAmt2);}}
switch(True){case((catFrom)=="accMove"):SetGridHeight(grdAccountBudgets,"32px");GridCenterAlign(grdAccountBudgets,3,3);GridRightAlign(grdAccountBudgets,1,2);AlternateGridColor(grdAccountBudgets);grdAccountBudgets.Left=0;grdAccountBudgets.Top=75;grdAccountBudgets.Height=AccountBudgets.Height-75;grdAccountBudgets.Width=AccountBudgets.Width;grdAccountBudgets.refresh();break;case((catFrom)=="accChart"):accountYearlyChart.Left=0;accountYearlyChart.Top=75;accountYearlyChart.Height=AccountBudgets.Height-75;accountYearlyChart.Width=AccountBudgets.Width;accountYearlyChart_settings.showBorderLine=False;accountYearlyChart_settings.source=accBudgetChart;accountYearlyChart_settings.categoryAxis={dataField:"period",showGridLines:True,textRotationAngle:-90}
accountYearlyChart_settings.seriesGroups=[{type:"column",valueAxis:{description:"Amounts",formatSettings:{prefix:"",thousandsSeparator:","}},series:[{dataField:"budget",displayText:"Budget"},{dataField:"actual",displayText:"Actual"},]}];$("#accountYearlyChart").jqxChart(accountYearlyChart_settings);}
NSB.ShowProgress(False);document.body.style.cursor='default';return savethefunction_rvar;}
function abError(transaction,results){savethefunction_rvar="";NSB.ShowProgress(False);NSB.MsgBox("SQL Error");document.body.style.cursor='default';return savethefunction_rvar;}
accountBudgetsTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Chart"):catFrom="accChart";LoadAccountBudgets();break;case((choice)=="Back"):switch(True){case((catFrom)=="accChart"):grdAccountBudgets.Visible=True;accountYearlyChart.Visible=False;grdAccountBudgets.refresh();catFrom="accMove";break;case((catFrom)=="accMove"):ChangeForm(AccountMovements);break;}}
return savethefunction_rvar;}
AccountBudgets.onshow=function(){savethefunction_rvar="";lblAccName.Width=AccountBudgets.Width;LoadAccountBudgets();return savethefunction_rvar;}
window.addEventListener('load',function(){AccountPerformance.style.display='block';NSB.addProperties(accPerformanceTitle);NSB.addDisableProperty(accPerformanceTitle);if(typeof(accPerformanceTitle_left)!='undefined')accPerformanceTitle_left.onclick=function(){accPerformanceTitle.onclick(accPerformanceTitle_left.getAttribute('nsbvalue'))};if(typeof(accPerformanceTitle_right)!='undefined')accPerformanceTitle_right.onclick=function(){accPerformanceTitle.onclick(accPerformanceTitle_right.getAttribute('nsbvalue'))};accPerformanceChart_settings={'title':'','background':'white','description':'','padding':{left:10,top:10,right:10,bottom:10},'titlePadding':{left:2,top:2,right:2,bottom:2},'colorScheme':'scheme01','showLegend':'true','enabled':'true','showToolTips':'true','toolTipDelay':'500'}
accPerformanceChart.style.position='relative';NSB.addProperties(accPerformanceChart,accPerformanceChart_wrapper);AccountPerformance.style.display='none';},false);AccountPerformance.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(AccountPerformance);function LoadAccountPerformance(){savethefunction_rvar="";document.body.style.cursor='wait';NSB.ShowProgress("Loading account performance...");var sQRY;sqlList=[];sQRY="SELECT AccountName, SUM(Actual) AS Actual FROM Accounts_Movement WHERE Actual > 0";sQRY=sQRY+" GROUP BY AccountName ORDER BY Actual DESC;";sqlList[0]=[sQRY,apHandler,apError];Sql(dbObj,sqlList);}
function apHandler(transaction,results){savethefunction_rvar="";cmData=[];for(i=0;i<=results.rows.length-1;i++){if(i<=9){var row;row={}
row["account"]=results.rows.item(i)["AccountName"];row["actual"]=results.rows.item(i)["Actual"];cmData[i]=row;}else{break;}}
accPerformanceChart.Left=0;accPerformanceChart.Top=accPerformanceTitle.Height;accPerformanceChart.Height=AccountPerformance.Height-accPerformanceTitle.Height;accPerformanceChart.Width=AccountPerformance.Width;accPerformanceChart_settings.showBorderLine=False;accPerformanceChart_settings.source=cmData;accPerformanceChart_settings.showLegend=False;accPerformanceChart_settings.categoryAxis={dataField:"account",showGridLines:True,textRotationAngle:-90}
accPerformanceChart_settings.seriesGroups=[{type:"column",valueAxis:{description:"Actual",formatSettings:{prefix:"",thousandsSeparator:","}},series:[{dataField:"actual",displayText:"Actual"},]}];$("#accPerformanceChart").jqxChart(accPerformanceChart_settings);NSB.ShowProgress(False);document.body.style.cursor='default';return savethefunction_rvar;}
function apError(transaction,results){savethefunction_rvar="";NSB.ShowProgress(False);NSB.MsgBox("SQL Error");document.body.style.cursor='default';return savethefunction_rvar;}
accPerformanceTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Back"):ChangeForm(MyAccounts);break;case((choice)=="Refresh"):LoadAccountPerformance();}
return savethefunction_rvar;}
AccountPerformance.onshow=function(){savethefunction_rvar="";LoadAccountPerformance();return savethefunction_rvar;}
window.addEventListener('load',function(){AccountReport.style.display='block';NSB.addProperties(accReportTitle);NSB.addDisableProperty(accReportTitle);if(typeof(accReportTitle_left)!='undefined')accReportTitle_left.onclick=function(){accReportTitle.onclick(accReportTitle_left.getAttribute('nsbvalue'))};if(typeof(accReportTitle_right)!='undefined')accReportTitle_right.onclick=function(){accReportTitle.onclick(accReportTitle_right.getAttribute('nsbvalue'))};grdAccReport_ref=new iScroll('grdAccReport_scroller',{bounce:true,zoom:false});grdAccReport.refresh=function(){setTimeout(NSB.refresh,100,grdAccReport_ref)};grdAccReport.GridRefreshWidth=function(){setTimeout(NSB.GridRefreshWidth,10,grdAccReport)};NSB.Grid_init('grdAccReport');NSB.addProperties(grdAccReport,grdAccReport_scroller)
AccountReport.style.display='none';},false);AccountReport.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(AccountReport);function LoadAccountReport(){savethefunction_rvar="";document.body.style.cursor='wait';NSB.ShowProgress("Loading account report...");rCnt=grdAccReport.getRowCount();grdAccReport.deleteRows(rCnt);grdAccReport.refresh();$("#grdAccReport td").css("font-family","helvetica");var sQRY;sqlList=[];sQRY="SELECT AccountName, SUM(Actual) AS Actual FROM Accounts_Movement WHERE Actual > 0";sQRY=sQRY+" GROUP BY AccountName ORDER BY Actual DESC;";sqlList[0]=[sQRY,arepHandler,arepError];Sql(dbObj,sqlList);}
function arepHandler(transaction,results){savethefunction_rvar="";rCnt=1;var sAmt;var row;var sPerc;var cTotal;cTotal=0;sPerc=0;for(i=0;i<=results.rows.length-1;i++){row=results.rows.item(i);cTotal=cTotal+row["Actual"];}
for(i=0;i<=results.rows.length-1;i++){row=results.rows.item(i);sAmt=row["Actual"];sPerc=sAmt/cTotal;sPerc=sPerc*100;sAmt=FormatNumber(sAmt,2);sPerc=FormatNumber(sPerc,2);grdAccReport.addRows(1);grdAccReport.setValue(rCnt,0,row["AccountName"]);grdAccReport.setValue(rCnt,1,sAmt);grdAccReport.setValue(rCnt,2,sPerc);rCnt=rCnt+1;}
SetGridHeight(grdAccReport,"32px");GridRightAlign(grdAccReport,1,2);AlternateGridColor(grdAccReport);grdAccReport.Left=0;grdAccReport.Top=accReportTitle.Height;grdAccReport.Height=AccountReport.Height-accReportTitle.Height;grdAccReport.Width=AccountReport.Width;grdAccReport.refresh();NSB.ShowProgress(False);document.body.style.cursor='default';return savethefunction_rvar;}
function arepError(transaction,results){savethefunction_rvar="";NSB.ShowProgress(False);NSB.MsgBox("SQL Error");document.body.style.cursor='default';return savethefunction_rvar;}
accReportTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Back"):ChangeForm(MyAccounts);break;case((choice)=="Refresh"):LoadAccountReport();}
return savethefunction_rvar;}
AccountReport.onshow=function(){savethefunction_rvar="";LoadAccountReport();return savethefunction_rvar;}
window.addEventListener('load',function(){Splash.style.display='block';NSB.addProperties(imgSplash);Splash.style.display='none';},false);Splash.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(Splash);Splash.onshow=function(){savethefunction_rvar="";imgSplash.Top=0;imgSplash.Left=0;imgSplash.Width=Splash.Width;imgSplash.Height=Splash.Height;Splash.style.webkitTransitionDuration="3000ms";Splash.style.webkitTransform="translateX(-"+SysInfo(0)+"px)";setTimeout(WhatToDoShow,3000);return savethefunction_rvar;}
function WhatToDoShow(){nsbDOMAttr(Splash,'style.display',"none");nsbDOMAttr(WhatToDo,'style.display',"block");WhatToDo.style.webkitTransform="translateX(0px)";ChangeForm(WhatToDo);}
window.addEventListener('load',function(){PaymentsReport.style.display='block';NSB.addProperties(paymentsTitle);NSB.addDisableProperty(paymentsTitle);if(typeof(paymentsTitle_left)!='undefined')paymentsTitle_left.onclick=function(){paymentsTitle.onclick(paymentsTitle_left.getAttribute('nsbvalue'))};if(typeof(paymentsTitle_right)!='undefined')paymentsTitle_right.onclick=function(){paymentsTitle.onclick(paymentsTitle_right.getAttribute('nsbvalue'))};grdPayments_ref=new iScroll('grdPayments_scroller',{bounce:true,zoom:false});grdPayments.refresh=function(){setTimeout(NSB.refresh,100,grdPayments_ref)};grdPayments.GridRefreshWidth=function(){setTimeout(NSB.GridRefreshWidth,10,grdPayments)};NSB.Grid_init('grdPayments');NSB.addProperties(grdPayments,grdPayments_scroller)
PaymentsReport.style.display='none';},false);PaymentsReport.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(PaymentsReport);var pTotal;function LoadPayments(){savethefunction_rvar="";document.body.style.cursor='wait';NSB.ShowProgress("Loading payments...");rCnt=grdPayments.getRowCount();grdPayments.deleteRows(rCnt);$("#grdPayments td").css("font-family","helvetica");sqlList=[];sqlList[0]=["DELETE FROM Payments WHERE Amount = 0;",plReset,plError];payBy=localStorage.getItem("payby");switch(True){case((payBy)=="YearMonth"):payYear=localStorage.getItem("payYear");payMonth=localStorage.getItem("payMonth");$("#paymentsTitle h1").text("Payments: "+payYear+payMonth);sqlList[0]=["SELECT SUM(Amount) AS Amount FROM Payments WHERE YearOn = "+payYear+" AND MonthOn = "+payMonth+";",pltHandler,pltError];sqlList[1]=["SELECT * FROM Payments WHERE YearOn = "+payYear+" AND MonthOn = "+payMonth+" ORDER BY DayOn DESC,Id DESC;",plHandler,plError];}
Sql(dbObj,sqlList);}
function pltHandler(transaction,results){savethefunction_rvar="";pTotal=results.rows.item(0)["Amount"];rCnt=1;grdPayments.addRows(1);grdPayments.setValue(rCnt,0,"Total");grdPayments.setValue(rCnt,1,"");grdPayments.setValue(rCnt,2,"");grdPayments.setValue(rCnt,3,"");grdPayments.setValue(rCnt,4,FormatNumber(pTotal,2));return savethefunction_rvar;}
function pltError(transaction,results){savethefunction_rvar="";pTotal=0;return savethefunction_rvar;}
function plReset(transaction,results){savethefunction_rvar="";console.log("Payments deleted");return savethefunction_rvar;}
function plHandler(transaction,results){savethefunction_rvar="";rCnt=rCnt+1;var sid,sfromaccount,stoaccount;var sdayon,smonthon,syearon;var sdescription,samount,sdate;dailyPayments=new Object();for(i=0;i<=results.rows.length-1;i++){row=results.rows.item(i);sid=row["Id"];sfromaccount=row["FromAccount"];stoaccount=row["ToAccount"];sdayon=row["DayOn"];smonthon=row["MonthOn"];syearon=row["YearOn"];sdescription=row["Description"];samount=row["Amount"];samount=FormatNumber(samount,2);if(Len(sdayon)==1){sdayon="0"+sdayon;}
if(Len(smonthon)==1){smonthon="0"+smonthon;}
sdate=syearon+"-"+smonthon+"-"+sdayon;grdPayments.addRows(1);grdPayments.setValue(rCnt,0,sdate);grdPayments.setValue(rCnt,1,sfromaccount);grdPayments.setValue(rCnt,2,stoaccount);grdPayments.setValue(rCnt,3,sdescription);grdPayments.setValue(rCnt,4,samount);rCnt=rCnt+1;}
SetGridHeight(grdPayments,"32px");GridRightAlign(grdPayments,4,4);AlternateGridColor(grdPayments);grdPayments.Left=0;grdPayments.Top=paymentsTitle.Height;grdPayments.Height=PaymentsReport.Height-paymentsTitle.Height;grdPayments.Width=PaymentsReport.Width;grdPayments.refresh();NSB.ShowProgress(False);document.body.style.cursor='default';return savethefunction_rvar;}
function plError(transaction,results){savethefunction_rvar="";NSB.ShowProgress(False);NSB.MsgBox("SQL Error");document.body.style.cursor='default';return savethefunction_rvar;}
paymentsTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Back"):ChangeForm(PaymentsSelector);}
return savethefunction_rvar;}
PaymentsReport.onshow=function(){savethefunction_rvar="";LoadPayments();return savethefunction_rvar;}
window.addEventListener('load',function(){PaymentsSelector.style.display='block';NSB.List_jqm_init('payPeriods','',true,'100%',false);payPeriods_ref=new iScroll('payPeriods_scroller',{bounce:true,zoom:false});payPeriods.refresh=function(){if(typeof payPeriods_ref!='undefined')setTimeout(NSB.refresh,100,payPeriods_ref)};NSB.addProperties(payPeriods,payPeriods_scroller);NSB.addProperties(payTitle);NSB.addDisableProperty(payTitle);if(typeof(payTitle_left)!='undefined')payTitle_left.onclick=function(){payTitle.onclick(payTitle_left.getAttribute('nsbvalue'))};if(typeof(payTitle_right)!='undefined')payTitle_right.onclick=function(){payTitle.onclick(payTitle_right.getAttribute('nsbvalue'))};PaymentsSelector.style.display='none';},false);PaymentsSelector.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(PaymentsSelector);function LoadPayPeriods(){savethefunction_rvar="";document.body.style.cursor='wait';NSB.ShowProgress("Loading pay periods...");payPeriods.Visible=False;payPeriods.deleteItem("all");sqlList=[];sqlList[0]=["DELETE FROM Payments WHERE Amount = 0;",ppReset,ppError];sqlList[1]=["SELECT YearOn,MonthOn FROM Payments GROUP BY YearOn,MonthOn ORDER BY YearOn DESC,MonthOn DESC;",ppHandler,ppError];Sql(dbObj,sqlList);}
function ppReset(transaction,result){savethefunction_rvar="";console.log("Payments deleted");return savethefunction_rvar;}
function ppHandler(transaction,results){savethefunction_rvar="";var row,sYearOn,sMonthOn;for(i=0;i<=results.rows.length-1;i++){row=results.rows.item(i);sMonthOn=row["MonthOn"];sYearOn=row["YearOn"];if(Len(sMonthOn)==1){sMonthOn="0"+sMonthOn;}
payPeriods.addItem(sYearOn+":"+sMonthOn);}
payPeriods.Visible=True;payPeriods.refresh();NSB.ShowProgress(False);document.body.style.cursor='default';return savethefunction_rvar;}
function ppError(transaction,results){savethefunction_rvar="";NSB.ShowProgress(False);NSB.MsgBox("SQL Error");document.body.style.cursor='default';return savethefunction_rvar;}
payPeriods.onclick=function(i){savethefunction_rvar="";if(TypeName(i)=="object"){return savethefunction_rvar;}
var strItem,strYM;strItem=payPeriods.getItem(i);strYM=Split(strItem,":");payYear=Trim(strYM[0]);payMonth=Trim(strYM[1]);localStorage.setItem("payby","YearMonth");localStorage.setItem("payYear",payYear);localStorage.setItem("payMonth",payMonth);ChangeForm(PaymentsReport);return savethefunction_rvar;}
payTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Back"):ChangeForm(MyPayments);}
return savethefunction_rvar;}
PaymentsSelector.onshow=function(){savethefunction_rvar="";payPeriods.Top=payTitle.Height;payPeriods.Height=PaymentsSelector.Height-payTitle.Height;LoadPayPeriods();return savethefunction_rvar;}
window.addEventListener('load',function(){FinancialReport.style.display='block';NSB.addProperties(finReportTitle);NSB.addDisableProperty(finReportTitle);if(typeof(finReportTitle_left)!='undefined')finReportTitle_left.onclick=function(){finReportTitle.onclick(finReportTitle_left.getAttribute('nsbvalue'))};if(typeof(finReportTitle_right)!='undefined')finReportTitle_right.onclick=function(){finReportTitle.onclick(finReportTitle_right.getAttribute('nsbvalue'))};grdFinReport_ref=new iScroll('grdFinReport_scroller',{bounce:true,zoom:false});grdFinReport.refresh=function(){setTimeout(NSB.refresh,100,grdFinReport_ref)};grdFinReport.GridRefreshWidth=function(){setTimeout(NSB.GridRefreshWidth,10,grdFinReport)};NSB.Grid_init('grdFinReport');NSB.addProperties(grdFinReport,grdFinReport_scroller)
FinancialReport.style.display='none';},false);FinancialReport.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(FinancialReport);var tAssets,tLiabilities;var tIncomes,tExpenses;var aAssets,aLiabilities;var aIncomes,aExpenses;var sLine,aTot,lTot,eTot,iTot,rTot,xLine;function LoadFinancialReport(){savethefunction_rvar="";document.body.style.cursor='wait';NSB.ShowProgress("Loading financial report...");rCnt=grdFinReport.getRowCount();grdFinReport.deleteRows(rCnt);grdFinReport.refresh();$("#grdFinReport td").css("font-family","helvetica");sqlList=[];sqlList[0]=["SELECT [Name],[TypeOf],[CurrentBalance] FROM Accounts WHERE CurrentBalance <> 0 ORDER BY TypeOf,[Name];",finrepHandler,finrepError];Sql(dbObj,sqlList);}
function finrepHandler(transaction,results){savethefunction_rvar="";rCnt=1;tAssets=0;tLiabilities=0;tIncomes=0;tExpenses=0;aAssets=createMultiDimArray('0');aLiabilities=createMultiDimArray('0');aIncomes=createMultiDimArray('0');aExpenses=createMultiDimArray('0');var sTypeOf,sCurrentBalance,sName;for(i=0;i<=results.rows.length-1;i++){row=results.rows.item(i);sTypeOf=row["TypeOf"];sCurrentBalance=row["CurrentBalance"];sName=row["Name"];if(parseFloat(sCurrentBalance)<0&&sTypeOf=="Assets"){sTypeOf="Liabilities";}
if(parseFloat(sCurrentBalance)>0&&sTypeOf=="Liabilities"){sTypeOf="Assets";}
sLine=sTypeOf+VM+sName+VM+sCurrentBalance;switch(True){case((sTypeOf)=="Assets"):tAssets=tAssets+sCurrentBalance;aTot=UBound(aAssets)+1;aAssets[aTot]=sLine;break;case((sTypeOf)=="Liabilities"):tLiabilities=tLiabilities+sCurrentBalance;lTot=UBound(aLiabilities)+1;aLiabilities[lTot]=sLine;break;case((sTypeOf)=="Incomes"):tIncomes=tIncomes+sCurrentBalance;iTot=UBound(aIncomes)+1;aIncomes[iTot]=sLine;break;case((sTypeOf)=="Expenses"):tExpenses=tExpenses+sCurrentBalance;eTot=UBound(aExpenses)+1;aExpenses[eTot]=sLine;}}
rCnt=1;AddFinReportRow(rCnt,"Assets","",tAssets);aTot=UBound(aAssets);if(aTot==0){aTot=1;}
for(i=0;i<=aTot-1;i++){sLine=aAssets[i];if(Len(sLine)>0){xLine=Split(sLine,VM);rCnt=rCnt+1;AddFinReportRow(rCnt,"",xLine[1],xLine[2]);}}
rCnt=rCnt+1;AddFinReportRow(rCnt,"Liabilities","",tLiabilities);lTot=UBound(aLiabilities);if(lTot==0){lTot=1;}
for(i=0;i<=lTot-1;i++){sLine=aLiabilities[i];if(Len(sLine)>0){xLine=Split(sLine,VM);rCnt=rCnt+1;AddFinReportRow(rCnt,"",xLine[1],xLine[2]);}}
rCnt=rCnt+1;AddFinReportRow(rCnt,"Incomes","",tIncomes);iTot=UBound(aIncomes);if(iTot==0){iTot=1;}
for(i=0;i<=iTot-1;i++){sLine=aIncomes[i];if(Len(sLine)>0){xLine=Split(sLine,VM);rCnt=rCnt+1;AddFinReportRow(rCnt,"",xLine[1],xLine[2]);}}
rCnt=rCnt+1;AddFinReportRow(rCnt,"Expenses","",tExpenses);eTot=UBound(aExpenses);if(eTot==0){eTot=1;}
for(i=0;i<=eTot-1;i++){sLine=aExpenses[i];if(Len(sLine)>0){xLine=Split(sLine,VM);rCnt=rCnt+1;AddFinReportRow(rCnt,"",xLine[1],xLine[2]);}}
SetGridHeight(grdFinReport,"32px");GridRightAlign(grdFinReport,2,2);AlternateGridColor(grdFinReport);grdFinReport.Left=0;grdFinReport.Top=finReportTitle.Height;grdFinReport.Height=FinancialReport.Height-finReportTitle.Height;grdFinReport.Width=FinancialReport.Width;grdFinReport.refresh;NSB.ShowProgress(False);document.body.style.cursor='default';return savethefunction_rvar;}
function AddFinReportRow(rowPos,xTypeOf,xName,xAmount){grdFinReport.addRows(1);grdFinReport.setValue(rowPos,0,xTypeOf);grdFinReport.setValue(rowPos,1,xName);grdFinReport.setValue(rowPos,2,FormatNumber(xAmount,2));}
function finrepError(transaction,results){savethefunction_rvar="";NSB.ShowProgress(False);NSB.MsgBox("SQL Error");document.body.style.cursor='default';return savethefunction_rvar;}
finReportTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Back"):ChangeForm(MyReports);break;case((choice)=="Refresh"):LoadFinancialReport();}
return savethefunction_rvar;}
FinancialReport.onshow=function(){savethefunction_rvar="";LoadFinancialReport();return savethefunction_rvar;}
window.addEventListener('load',function(){Charts.style.display='block';NSB.addProperties(chartsTitle);NSB.addDisableProperty(chartsTitle);if(typeof(chartsTitle_left)!='undefined')chartsTitle_left.onclick=function(){chartsTitle.onclick(chartsTitle_left.getAttribute('nsbvalue'))};if(typeof(chartsTitle_right)!='undefined')chartsTitle_right.onclick=function(){chartsTitle.onclick(chartsTitle_right.getAttribute('nsbvalue'))};chartObj_settings={'title':'','background':'white','description':'','padding':{left:10,top:10,right:10,bottom:10},'titlePadding':{left:2,top:2,right:2,bottom:2},'colorScheme':'scheme01','showLegend':'true','enabled':'true','showToolTips':'true','toolTipDelay':'500'}
chartObj.style.position='relative';NSB.addProperties(chartObj,chartObj_wrapper);Charts.style.display='none';},false);Charts.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(Charts);var chartTitle;function LoadCharts(){savethefunction_rvar="";document.body.style.cursor='wait';NSB.ShowProgress("Loading chart...");sqlList=[];chartPer=LCase(chartPer);switch(True){case((chartPer)=="al"):Query="SELECT [TypeOf],[CurrentBalance] FROM Accounts WHERE CurrentBalance <> 0 AND TypeOf IN ('Assets','Liabilities');";break;case((chartPer)=="ie"):Query="SELECT [TypeOf],[CurrentBalance] FROM Accounts WHERE CurrentBalance <> 0 AND TypeOf IN ('Incomes','Expenses');";}
sqlList[0]=[Query,chartHandler,chartError];Sql(dbObj,sqlList);}
function chartHandler(transaction,results){savethefunction_rvar="";var tAssets,tLiabilities;var tIncomes,tExpenses,row;tAssets=0;tLiabilities=0;tIncomes=0;tExpenses=0;cmData=[];for(i=0;i<=results.rows.length-1;i++){row=results.rows.item(i);sTypeOf=row["TypeOf"];sCurrentBalance=row["CurrentBalance"];if(parseFloat(sCurrentBalance)<0&&sTypeOf=="Assets"){sTypeOf="Liabilities";}
if(parseFloat(sCurrentBalance)>0&&sTypeOf=="Liabilities"){sTypeOf="Assets";}
switch(True){case((sTypeOf)=="Assets"):tAssets=tAssets+sCurrentBalance;break;case((sTypeOf)=="Liabilities"):tLiabilities=tLiabilities+sCurrentBalance;break;case((sTypeOf)=="Incomes"):tIncomes=tIncomes+sCurrentBalance;break;case((sTypeOf)=="Expenses"):tExpenses=tExpenses+sCurrentBalance;}}
switch(True){case((chartPer)=="al"):chartTitle="Assets vs Liabilities";$("#chartsTitle h1").text(chartTitle);tLiabilities=tLiabilities*(0-1);row={}
row["Name"]="Assets";row["Value"]=tAssets;cmData[0]=row;row={}
row["Name"]="Liabilities";row["Value"]=tLiabilities;cmData[1]=row;break;case((chartPer)=="ie"):chartTitle="Incomes vs Expenses";$("#chartsTitle h1").text(chartTitle);tIncomes=tIncomes*(0-1);row={}
row["Name"]="Incomes";row["Value"]=tIncomes;cmData[0]=row;row={}
row["Name"]="Expenses";row["Value"]=tExpenses;cmData[1]=row;}
chartObj_settings.showBorderLine=False;chartObj_settings.source=cmData;chartObj_settings.showLegend=True;chartObj_settings.colorScheme="scheme03";chartObj_settings.seriesGroups=[{type:"pie",showLabels:True,series:[{dataField:"Value",labelRadius:100,initialAngle:15,centerOffset:0,formatSettings:{prefix:"",thousandsSeparator:","},displayText:"Name"},]}];$("#chartObj").jqxChart(chartObj_settings);NSB.ShowProgress(False);document.body.style.cursor='default';return savethefunction_rvar;}
function chartError(transaction,results){savethefunction_rvar="";NSB.ShowProgress(False);NSB.MsgBox("SQL Error");document.body.style.cursor='default';return savethefunction_rvar;}
chartsTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Back"):ChangeForm(MyReports);}
return savethefunction_rvar;}
Charts.onshow=function(){savethefunction_rvar="";chartObj.Left=0;chartObj.Top=chartsTitle.Height;chartObj.Height=Charts.Height-chartsTitle.Height;chartObj.Width=Charts.Width;LoadCharts();return savethefunction_rvar;}
window.addEventListener('load',function(){Account.style.display='block';NSB.addProperties(accTitle);NSB.addDisableProperty(accTitle);if(typeof(accTitle_left)!='undefined')accTitle_left.onclick=function(){accTitle.onclick(accTitle_left.getAttribute('nsbvalue'))};if(typeof(accTitle_right)!='undefined')accTitle_right.onclick=function(){accTitle.onclick(accTitle_right.getAttribute('nsbvalue'))};NSB.addProperties(lblAccountNo);NSB.addProperties(lblAccountName);NSB.addProperties(lblAccountCategory);NSB.addProperties(lblAccountInstitution);NSB.addProperties(lblAccountOpenBal);NSB.addProperties(lblAccountCurrBal);NSB.addProperties(lblAccountInstallment);NSB.addProperties(lblAccountType);if(typeof txtAccountNo==='undefined')txtAccountNo=document.getElementById('txtAccountNo')
txtAccountNo.addEventListener('touchmove',function(e){e.stopPropagation();},false);NSB.addProperties(txtAccountNo,$('#txtAccountNo_wrapper > div')[0]);NSB.addDisableProperty(txtAccountNo)
if(typeof txtAccountName==='undefined')txtAccountName=document.getElementById('txtAccountName')
txtAccountName.addEventListener('touchmove',function(e){e.stopPropagation();},false);NSB.addProperties(txtAccountName,$('#txtAccountName_wrapper > div')[0]);NSB.addDisableProperty(txtAccountName)
if(typeof txtAccountOpenBal==='undefined')txtAccountOpenBal=document.getElementById('txtAccountOpenBal')
txtAccountOpenBal.addEventListener('touchmove',function(e){e.stopPropagation();},false);NSB.addProperties(txtAccountOpenBal,$('#txtAccountOpenBal_wrapper > div')[0]);NSB.addDisableProperty(txtAccountOpenBal)
if(typeof txtAccountCurrBal==='undefined')txtAccountCurrBal=document.getElementById('txtAccountCurrBal')
txtAccountCurrBal.addEventListener('touchmove',function(e){e.stopPropagation();},false);NSB.addProperties(txtAccountCurrBal,$('#txtAccountCurrBal_wrapper > div')[0]);NSB.addDisableProperty(txtAccountCurrBal)
if(typeof txtAccountInstallment==='undefined')txtAccountInstallment=document.getElementById('txtAccountInstallment')
txtAccountInstallment.addEventListener('touchmove',function(e){e.stopPropagation();},false);NSB.addProperties(txtAccountInstallment,$('#txtAccountInstallment_wrapper > div')[0]);NSB.addDisableProperty(txtAccountInstallment)
NSB.addProperties(lblAccountPayFrom);chkAccountPayFrom.value=function(){return chkAccountPayFrom_inner.options[chkAccountPayFrom_inner.selectedIndex].innerHTML;}
chkAccountPayFrom.setValue=function(n){$('#chkAccountPayFrom_inner').val(n).slider('refresh');}
$('#chkAccountPayFrom .ui-slider-switch').css('width','95px')
$('#chkAccountPayFrom>div').css('width','100%').css('height','100%');NSB.addDisableProperty(chkAccountPayFrom);NSB.addProperties(chkAccountPayFrom);delete cboAccountCategory.childNodes[0];NSB.ComboBox_init('cboAccountCategory');NSB.addProperties(cboAccountCategory);delete cboAccountType.childNodes[0];NSB.ComboBox_init('cboAccountType');NSB.addProperties(cboAccountType);delete cboAccountInstitution.childNodes[0];NSB.ComboBox_init('cboAccountInstitution');NSB.addProperties(cboAccountInstitution);Account.style.display='none';},false);Account.onsubmit=function(event){window.event.cancelBubble=true;window.event.returnValue=false};NSB.addProperties(Account);function LoadAccountLists(){document.body.style.cursor='wait';NSB.ShowProgress("Loading lists...");cboAccountCategory.clear();cboAccountCategory.addItem("---Select---","---Select---");cboAccountInstitution.clear();cboAccountInstitution.addItem("---Select---","---Select---");cboAccountType.clear();cboAccountType.addItem("---Select---","---Select---");cboAccountType.addItem("Assets","Assets");cboAccountType.addItem("Liabilities","Liabilities");cboAccountType.addItem("Incomes","Incomes");cboAccountType.addItem("Expenses","Expenses");cboAccountCategory.setIndex(0);cboAccountInstitution.setIndex(0);cboAccountType.setIndex(0);sqlList=[];sqlList[0]=["SELECT CategoryName from Categories ORDER BY CategoryName;",lst1Handler];sqlList[1]=["SELECT Name from Institutions ORDER BY Name;",lst2Handler];Sql(dbObj,sqlList);NSB.ShowProgress(False);document.body.style.cursor='default';}
function lst1Handler(transaction,results){savethefunction_rvar="";var row,sCategoryName;for(i=0;i<=results.rows.length-1;i++){row=results.rows.item(i);sCategoryName=row["CategoryName"];cboAccountCategory.addItem(sCategoryName,sCategoryName);}
return savethefunction_rvar;}
function lst2Handler(transaction,results){savethefunction_rvar="";var row,sName;for(i=0;i<=results.rows.length-1;i++){row=results.rows.item(i);sName=row["Name"];cboAccountInstitution.addItem(sName,sName);}
return savethefunction_rvar;}
accTitle.onclick=function(choice){savethefunction_rvar="";if(TypeName(choice)=="object"){return savethefunction_rvar;}
switch(True){case((choice)=="Back"):ChangeForm(AccountsList);break;case((choice)=="Save"):}
return savethefunction_rvar;}
Account.onshow=function(){savethefunction_rvar="";AccountClear();return savethefunction_rvar;}
function AccountClear(){txtAccountNo.value="";txtAccountName.value="";txtAccountOpenBal.value="0.00";txtAccountCurrBal.value="0.00";txtAccountInstallment.value="0.00";chkAccountPayFrom.value="No";LoadAccountLists();}
window.addEventListener('load',function(){Splash.style.display='block';Main();if(typeof(Splash.onshow)=='function')Splash.onshow();},false);var NSBCurrentForm=Splash;